---
import "../style/style.css";
import "../layout/layout.css";
import Header_card from "../components/header_card.astro";
import Footer from "../components/footer.astro";
import Banner from "../components/banner.astro";
import Overskift from "../components/overskift.astro";
import ProductCard from "../components/productCard.astro";
import Tilbage_knap from "../components/tilbage_knap.astro";
import Kurv from "../components/kurv.astro";
import UndersideHeader from "../components/undersideHeader.astro";

const data = await fetch(
  "https://dmmsxgbleguwsrjxcdfh.supabase.co/rest/v1/ae_blomster",
  {
    method: "GET",
    headers: {
      apikey:
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRtbXN4Z2JsZWd1d3NyanhjZGZoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTUzMjU0NjMsImV4cCI6MjAzMDkwMTQ2M30.EUV_DuoCBgYOjjmQ10T54Q80kiR6_fejdBF3RdWfbv8",
    },
  }
).then((response) => response.json());

const categories = ["all", "Buket", "Plante", "Vase"];
---

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="stylesheet" href="https://use.typekit.net/heg3tgx.css" />
    <link rel="icon" href="svg/logo.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>Udvalg</title>
  </head>
  <header>
    <Banner />
    <div class="grid_1-1">
      <a href="/#"><Tilbage_knap /></a>
      <UndersideHeader />
    </div>
  </header>
  <main>
    <Overskift text="Udvalg" />

    <div id="filter-buttons" class="demo">
      <p>Filter:</p>
      <div class="style">
        {
          categories.map((category) => (
            <button type="button" onClick={`filterItems('${category}')`}>
              {category}
            </button>
          ))
        }
      </div>
    </div>

    <section id="product-grid" class="udvalg_grid">
      {
        data.map((blomst) => (
          <ProductCard
            key={blomst.id}
            data={blomst}
            loading="lazy"
            data-category={blomst.category}
          />
        ))
      }
    </section>
  </main>
  <footer><Footer /></footer>
  <style>
    .udvalg_grid {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      margin: 5%;
      gap: 5%;
    }

  .demo{
    font-size: 16px;
      line-height: 0.5;
    }

    .style button {
  background-color: var(--drak_green); 
  border: none; 
  color: white; 
  padding: 10px 8px; 
  text-align: center; 
  text-decoration: none; 
  display: inline-block; 
  font-size: 16px; 
  margin: 4px 2px; 
  cursor: pointer; 
  border-radius: 8px; 
  transition-duration: 0.4s; 
}

.style button:hover {
  color: var(--pink); 
}


    @media screen and (max-width: 1100px) {
      .udvalg_grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        padding: 10px;
      }
    }
    @media screen and (max-width: 700px) {
      .overskrift {
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
      }

      .overskrift img {
        margin-top: 20px;
      }

      .udvalg_grid {
        display: block;
        padding: 10px;
      }
    }
  </style>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      function filterItems(category) {
        console.log("Filtering items for category:", category); // Debug information
        const items = document.querySelectorAll(".udvalg_grid > *");
        items.forEach((item) => {
          const itemCategory = item.getAttribute("data-category");
          console.log("Item category:", itemCategory); // Debug information
          if (category === "all" || itemCategory === category) {
            item.style.display = "block";
          } else {
            item.style.display = "none";
          }
        });
      }

      // Make filterItems available globally
      window.filterItems = filterItems;

      // Show all items by default
      filterItems("all");
    });
  </script>

  <!-- <script>
  async function fetchData() {
    const response = await fetch(
      "https://dmmsxgbleguwsrjxcdfh.supabase.co/rest/v1/ae_blomster",
      {
        method: "GET",
        headers: {
          apikey:
            "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRtbXN4Z2JsZWd1d3NyanhjZGZoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTUzMjU0NjMsImV4cCI6MjAzMDkwMTQ2M30.EUV_DuoCBgYOjjmQ10T54Q80kiR6_fejdBF3RdWfbv8",
        },
      }
    );
    return response.json();
  }

  async function filterProducts(category) {
    const productList = document.getElementById('product-grid');
    productList.innerHTML = ''; // Nulstil produktlisten

    const products = await fetchData();

    if (category === 'all') {
      // Vis alle produkter, hvis kategorien er "Alle"
      products.forEach(product => {
        productList.innerHTML += `<div>${product.name}</div>`; // Udskriv produktets navn
      });
    } else {
      // Vis kun produkter med den valgte kategori
      const filteredProducts = products.filter(product => product.category.toLowerCase() === category.toLowerCase());
      filteredProducts.forEach(product => {
        productList.innerHTML += `<div>${product.name}</div>`; // Udskriv produktets navn
      });
    }
  }

  // Initial visning af alle produkter
  window.onload = () => {
    filterProducts('all');
  };
</script> -->


</html>
